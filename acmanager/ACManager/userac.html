<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>做题统计</title>
  <script src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="https://cdn.bootcss.com/datatables/1.10.13/js/jquery.dataTables.min.js"></script>
  <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.bootcss.com/datatables/1.10.13/css/jquery.dataTables.min.css">
  <style>
    .table-solid {
      border: 1px solid red;
    }

    table {
      margin: 5px;
    }

    .headback {
      height: 150px;
      width: 100%;
      margin-top: -17px;
      padding-top: 25px;
      background-color: #3399FF;
      color: #ffffff;
    }

    .myp {
      display: block;
      padding: 10px 10px 5px 10px;
      margin-top: -17px;
    }
  </style>
</head>

<body>
  <div>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header">
          <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">ACManager</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li>
              <a href="index.html">首页</a>
            </li>
            <li class="active">
              <a href="#">做题统计</a>
            </li>
            <li>
              <a href="match_statistics.html">比赛统计</a>
            </li>
            <li>
              <a href="#">做题训练</a>
            </li>
            <li>
              <a href="#">集训管理</a>
            </li>
            <li>
              <a href="#">队内博客</a>
            </li>
            <li>
              <a href="#">队员去向</a>
            </li>
            <li>
              <a href="#">近期比赛</a>
            </li>
            <li>
              <a href="#">API</a>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="#">登陆</a>
            </li>
            <li>
              <a href="#">注册</a>
            </li>
          </ul>
        </div>
        <!-- /.navbar-collapse -->
      </div>
      <!-- /.container-fluid -->
    </nav>
  </div>

  <div class="bg-primary myp">
    <div class="container">
      <p>队员做题统计结果
        <span style="font-family: Lobster, Monospace;">(Players do statistical results)</span>
      </p>
    </div>
  </div>
  <div class="container">
    <div class="jumbotron">
      <div class="row">
        <div class="col-md-1">
          <button class="btn btn-success">更新数据</button>
        </div>
        <div class="col-md-1">
          <button class="btn btn-success" onclick="export_table()">导出表格</button>
        </div>
        <div class="col-md-1">
          <button class="btn btn-success">入门经典</button>
        </div>
        <div class="col-md-1">
          <button class="btn btn-success">训练指南</button>
        </div>
        <div class="col-md-2">
          <div class="btn-group">
            <button type="button" class="btn btn-success">Sort By</button>
            <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="caret"></span>
              <span class="sr-only">Toggle Dropdown</span>
            </button>
            <ul class="dropdown-menu">
              <li>
                <a href="#">姓名</a>
              </li>
              <li>
                <a href="#">班级</a>
              </li>
              <li>
                <a href="#">总计</a>
              </li>
              <li>
                <a href="#">UVa</a>
              </li>
              <li>
                <a href="#">紫书+蓝书</a>
              </li>
              <li>
                <a href="#">紫书</a>
              </li>
              <li>
                <a href="#">蓝书</a>
              </li>
              <li>
                <a href="#">UVA</a>
              </li>
              <li>
                <a href="#">UVALive</a>
              </li>
              <li>
                <a href="#">51Nod</a>
              </li>
              <li>
                <a href="#">CodeForces</a>
              </li>
              <li>
                <a href="#">FZU</a>
              </li>
              <li>
                <a href="#">Gym</a>
              </li>
              <li>
                <a href="#">HDU</a>
              </li>
              <li>
                <a href="#">HYSBZ</a>
              </li>
              <li>
                <a href="#">LightOJ</a>
              </li>
              <li>
                <a href="#">OpenJ_POJ</a>
              </li>
              <li>
                <a href="#">POJ</a>
              </li>
              <li>
                <a href="#">SGU</a>
              </li>
              <li>
                <a href="#">URAL</a>
              </li>
              <li>
                <a href="#">ZOJ</a>
              </li>
            </ul>
          </div>
        </div>
        <div class="col-md-2"></div>
        <div class="col-md-4">
          <form class="form-inline">
            <div class="form-group">
              <input type="text" class="form-control" id="exampleInputEmail3" placeholder="Search">
            </div>
            <button type="submit" class="btn btn-default">确定</button>
          </form>
        </div>
      </div>
      <!--class row end-->

      <hr>
      <div class="row">
        <div class="col-md-2">

        </div>
      </div>
      <div class="row">
        <div class="col-md-12"></div>
      </div>
      <div class="panel panel-primary">
        <div class="panel-heading">
          <h3 class="panel-title">总览</h3>
        </div>
        <div class="panel-body">
          <table id="table" class="table table-condensed table-striped">
          </table>
        </div>
      </div>

      <hr>
      <div class="row">
        <div class="col-md-4">
          <nav aria-label="Page navigation">
            <ul class="pagination">
              <li>
                <a href="#" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                </a>
              </li>
              <li>
                <a href="#">1</a>
              </li>
              <li>
                <a href="#">2</a>
              </li>
              <li>
                <a href="#">3</a>
              </li>
              <li>
                <a href="#">4</a>
              </li>
              <li>
                <a href="#">5</a>
              </li>
              <li>
                <a href="#" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>

  </div>
  <footer style="margin-top: 20px" class="text-center">
    <p>Developer:
      <a href="#">Geekun</a> |
      <a href="#">Kela</a> |
      <a href="#">Yang</a> GitHub:
      <a href="#">
        <img src="image/github.jpg" style="width: 30px; height: 20px;">
      </a>
    </p>
    <p>All Copyright Reserved ©2016-2017
      <a href="#">SDUST</a> ACM Team.</p>
  </footer>

  <script>
    function get_data(url) {
      var jqxhr = $.ajax(url, {
        dataType: 'json',
        async: false,
      });
      let json = JSON.parse(jqxhr.responseText);
      return json;
    }
    function get_user_item() {
      var problem_statistics = new Array();
      var user_datas = get_data('http://www.92ac.cn:8009/api/ac?format=json');
      if (user_datas == null) console.log('user_datas is empty');
      ojs = user_datas["ojs"];
      for (let user_data of user_datas["ac"]) {
        problem_statistic = new Map();
        problem_statistic.set("username", user_data["username"]);
        problem_statistic.set("realName", user_data["realName"]);
        for (let item of user_data["count"]) {
          problem_statistic.set(item["oj_name"], item["count"]);
        }
        problem_statistics.push(problem_statistic);
      }
      return problem_statistics;
    }
    function product_form() {
      table = $("#table");
      problem_statistics = get_user_item();
      tr_header = $("<tr></tr>");
      tr_header.append("<td>" + "姓名" + "</td>");
      for (let oj of ojs) {
        tr_header.append("<td>" + oj + "</td>");
      }
      thead = $("<thead></thead>");
      thead.append(tr_header);
      table.append(thead);
      let tbody = $("<tbody></tbody");
      for (let problem_statistic of problem_statistics) {
        tr = $("<tr></tr>")
        tr.append("<td>" + problem_statistic.get("realName") + "</td>")
        for (let oj of ojs) {
          let num = problem_statistic.get(oj);
          if (num) {
            tr.append("<td>" + problem_statistic.get(oj) + "</td>");
          } else {
            tr.append("<td>" + "0" + "</td>");
          }
        }
        tbody.append(tr);
      }
      table.append(tbody);
    }
    product_form();
  </script>
   <script>
     //导出表格
      /*
       *  jQuery table2excel - v1.0.2
       *  jQuery plugin to export an .xls file in browser from an HTML table
       *  https://github.com/rainabba/jquery-table2excel
       *
       *  Made by rainabba
       *  Under MIT License
       */
      !function (a, b, c, d) { function e(b, c) { this.element = b, this.settings = a.extend({}, h, c), this._defaults = h, this._name = g, this.init() } function f(a) { return (a.filename ? a.filename : "table2excel") + (a.fileext ? a.fileext : ".xlsx") } var g = "table2excel", h = { exclude: ".noExl", name: "Table2Excel" }; e.prototype = { init: function () { var b = this, c = '<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">'; b.template = { head: '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">' + c + "<head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>", sheet: { head: "<x:ExcelWorksheet><x:Name>", tail: "</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>" }, mid: "</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>", table: { head: "<table>", tail: "</table>" }, foot: "</body></html>" }, b.tableRows = [], a(b.element).each(function (c, d) { var e = ""; a(d).find("tr").not(b.settings.exclude).each(function (b, c) { e += "<tr>" + a(c).html() + "</tr>" }), b.tableRows.push(e) }), b.tableToExcel(b.tableRows, b.settings.name, b.settings.sheetName) }, tableToExcel: function (d, e, g) { var h, i, j, k = this, l = ""; if (k.uri = "data:application/vnd.ms-excel;base64,", k.base64 = function (a) { return b.btoa(unescape(encodeURIComponent(a))) }, k.format = function (a, b) { return a.replace(/{(\w+)}/g, function (a, c) { return b[c] }) }, g = "undefined" == typeof g ? "Sheet" : g, k.ctx = { worksheet: e || "Worksheet", table: d, sheetName: g }, l = k.template.head, a.isArray(d)) for (h in d) l += k.template.sheet.head + g + h + k.template.sheet.tail; if (l += k.template.mid, a.isArray(d)) for (h in d) l += k.template.table.head + "{table" + h + "}" + k.template.table.tail; l += k.template.foot; for (h in d) k.ctx["table" + h] = d[h]; if (delete k.ctx.table, "undefined" != typeof msie && msie > 0 || navigator.userAgent.match(/Trident.*rv\:11\./)) if ("undefined" != typeof Blob) { for (var h in d) { var r = eval("/{table[" + h + "]}/"); l = l.replace(r, d[h]); } l = [l]; var m = new Blob(l, { type: "text/html" }); b.navigator.msSaveBlob(m, f(k.settings)) } else txtArea1.document.open("text/html", "replace"), txtArea1.document.write(k.format(l, k.ctx)), txtArea1.document.close(), txtArea1.focus(), sa = txtArea1.document.execCommand("SaveAs", !0, f(k.settings)); else i = k.uri + k.base64(k.format(l, k.ctx)), j = c.createElement("a"), j.download = f(k.settings), j.href = i, c.body.appendChild(j), j.click(), c.body.removeChild(j); return !0 } }, a.fn[g] = function (b) { var c = this; return c.each(function () { a.data(c, "plugin_" + g) || a.data(c, "plugin_" + g, new e(this, b)) }), c } }(jQuery, window, document);
    function export_table() {
      $("#table").table2excel({
        name: "doc",
        filename: "队员做题统计结果",
      });
    }
  </script>
</body>

</html>